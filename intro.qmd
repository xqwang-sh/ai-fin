---
title: "课程简介与预备知识"
subtitle: "AI时代的金融研究范式"
---

## 课程概览与学习目标

本课程旨在帮助研究生系统掌握将**人工智能方法**应用于**金融实证研究**的完整工作流程。我们不仅关注技术工具的使用，更强调：

1. **严谨的科学方法论**：如何在金融场景中正确设计、评估和解释AI模型
2. **可复现的研究规范**：从数据处理到结果报告的完整证据链
3. **经济意义的检验**：确保统计显著性转化为实际的经济价值
4. **前沿技术的应用**：文本分析、多模态学习等现代AI方法在金融中的实践

### 课程结构

本课程共8周，分为两个阶段：

**第一阶段（第1-4周）：教师精讲**

- **第1周**：机器学习基础——i.i.d.场景下的认知框架
- **第2周**：资产定价中的ML应用——时序评估与回测规范
- **第3周**：金融文本分析——从原始文本到量化信号
- **第4周**：多模态模型——图像/音频/视频在金融中的应用

**第二阶段（第5-8周）：学生研究汇报与研讨**

- 分组汇报研究计划，课堂讨论与反馈
- 第5周前有**课前测验**（覆盖第1-4周核心概念）

## 日常使用AI的思维模式

### "老板与员工"的协作框架

在AI辅助的研究工作中，你需要建立一种**"老板委派任务、验收员工成果"**的思维模式：

::: {.callout-tip}
老板的职责（你的角色）

1. **明确目标**：清晰定义研究问题、数据范围、评估标准
2. **拆解任务**：将复杂问题分解为可执行的具体步骤
3. **质量把关**：验收AI生成的代码、分析结果，确保符合学术规范
4. **决策判断**：在多个技术方案间权衡，做出关键的研究决策
:::

::: {.callout-warning}
员工的角色（AI工具）

- 高效执行具体任务（数据清洗、模型训练、代码生成等）
- 提供技术建议和多种实现方案
- 快速迭代和试错
- **但不能替代你的领域知识、研究判断和责任担当**
:::

### 验收工作的关键原则

无论AI生成的代码看起来多么完美，你都必须做到：

1. **理解逻辑**：确保你理解每段代码的功能和数学原理
2. **检查输出**：验证数据维度、统计量、可视化结果是否合理
3. **测试边界**：用极端情况测试代码（如空数据、缺失值、异常值）
4. **溯源数据**：追溯数据来源、时间对齐、变量定义
5. **可复现性**：确保设置随机种子、记录环境、版本锁定

::: {.callout-important}
学术诚信提醒

AI工具可以辅助你**完成任务**，但不能替代你**理解和负责**。所有提交的研究成果，你都必须能够独立解释其原理、假设和局限性。
:::

## AI辅助编程：Cursor Agent 模式

### 为什么需要 Coding Agent？

传统的"复制-粘贴式"AI辅助编程存在诸多问题：
- 代码片段缺乏上下文，难以整合到项目中
- 频繁在IDE和浏览器间切换，效率低下
- 难以处理多文件、跨模块的复杂任务

**Cursor Agent 模式**让AI直接在你的开发环境中工作，理解项目全貌，自动完成文件读写、代码编辑、终端操作等任务。

### 推荐工具：Cursor IDE

我们推荐使用 **Cursor IDE**，它提供：

1. **内置 Claude Opus 4.5 模型**
   - 目前最强的代码生成模型
   - 长上下文窗口（200k tokens）：可理解大型代码库
   - 支持多轮对话和迭代优化

2. **Agent 模式**（默认模式）
   - AI可以自主读取、编辑、创建文件
   - 运行终端命令、安装依赖
   - 自动修复错误
   - 批量编辑多个文件

3. **Plan 模式**（规划优先模式）
   - 按 `Shift+Tab` 切换到 Plan 模式
   - AI会先研究代码库，询问澄清性问题
   - 生成详细实施计划，等待你批准后再开始编码
   - 计划可保存到 `.cursor/plans/` 供团队参考

::: {.callout-tip}
**何时使用 Plan 模式？**

对于复杂任务（需要修改多个文件、涉及架构决策、需求不明确），建议先用 Plan 模式：

1. 按 `Shift+Tab` 激活 Plan 模式
2. 描述你的需求："添加用户认证功能"
3. AI会提出问题并生成实施计划
4. 审阅计划，点击"开始构建"后切换到 Agent 模式执行
:::

### 其他 AI 编程工具选择

除了 Cursor IDE，还有其他优秀的 AI 辅助编程工具可供选择。根据你的需求和偏好，可以考虑以下选项：

#### 1. **Claude Code** (Anthropic 官方)

**Claude Code** 是 Anthropic 官方推出的 AI 编程助手，提供与 Claude 的原生集成：

- **优势**：
  - 官方支持，与 Claude 模型深度整合
  - 支持多种编程语言和框架
  - 提供代码审查、重构、解释等功能
  - 可以理解复杂的项目结构

- **适用场景**： 
  - 需要 Claude 的长上下文能力
  - 希望使用官方支持的工具
  - 多语言项目开发

- **获取方式**：访问 [https://claude.ai/code](https://claude.ai/code)

#### 2. **Codex CLI** (OpenAI 命令行工具)

**Codex CLI** 是基于 OpenAI Codex 的命令行编程助手：

- **优势**：
  - 轻量级，无需图形界面
  - 适合服务器端开发和自动化脚本
  - 可集成到现有工作流中
  - 支持 shell 命令建议和自动化

- **适用场景**：
  - 偏好命令行工作
  - 自动化运维和脚本开发
  - 需要快速的代码补全

- **安装**：
  ```bash
  pip install openai-codex-cli
  # 或通过 npm
  npm install -g @openai/codex-cli
  ```

#### 3. **国内 IDE 选择**

考虑到网络访问和本地化需求，国内也有优秀的 AI 编程工具：

##### **Trae**

- **特点**：
  - 专为中国开发者优化
  - 支持国产大模型（如通义千问、文心一言等）
  - 更好的中文代码注释和文档支持
  - 无需科学上网，访问稳定

- **适用场景**：
  - 网络访问受限
  - 需要中文技术支持
  - 偏好国产工具

- **获取**：访问 [https://trae.ai](https://trae.ai) （示例 URL，请根据实际情况更新）

##### **Kimi Code**

- **特点**：
  - 由月之暗面（Moonshot AI）推出
  - 基于 Kimi 大模型，擅长长文本理解
  - 支持超长上下文（可达 200k tokens）
  - 本土化的代码建议和最佳实践

- **适用场景**：
  - 需要处理大型代码库
  - 长文档和复杂项目分析
  - 希望使用国产先进模型

- **获取**：访问 [https://kimi.ai/code](https://kimi.ai/code) （示例 URL，请根据实际情况更新）

::: {.callout-note}
**如何选择？**

- **Cursor**：功能最全面，Agent 模式最强大，推荐作为主力工具
- **Claude Code**：适合 Claude Pro 用户，同时也可以接 GLM 4.7
- **Codex CLI**：适合 ChatGPT 用户
- **Trae/Kimi Code**：网络受限或偏好国产工具时的优选

建议先从 Cursor 或国内工具（如 Kimi Code）开始，掌握基本工作流后，再根据具体需求探索其他工具。
:::

### Cursor 使用技巧

#### 技巧 1: **用 @ 引用上下文**

Cursor 使用 `@` 符号让你精确控制 AI 可以看到的上下文：

**引用特定文件：**
```markdown
@data_loader.py @config.yaml 
请根据配置文件中的参数更新数据加载逻辑
```

**引用整个文件夹：**
```markdown
@features/ 检查所有特征工程模块，
确保它们都正确处理了缺失值
```

**引用网页内容（用于查询文档）：**
```markdown
@https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html
用 sklearn 的 RandomForest 实现一个基准模型
```

#### 技巧 2: **先规划再执行**

在开始编码前，让AI帮你规划项目结构（使用 Plan 模式）：

```markdown
我需要构建一个股票收益率预测项目，包括：
- 数据加载和清洗
- 特征工程（技术指标 + 基本面）
- 模型训练和回测
- 结果可视化

请帮我设计项目结构和实施步骤
```

AI会生成类似这样的规划：

```
project/
├── data/
│   ├── raw/              # 原始数据（只读）
│   ├── processed/        # 处理后的数据
│   └── loader.py
├── features/
│   ├── technical.py      # 技术指标
│   └── fundamental.py    # 基本面特征
├── models/
│   ├── baseline.py
│   └── ml_models.py
├── evaluation/
│   ├── metrics.py
│   └── backtest.py
├── notebooks/
│   └── exploratory.ipynb
├── config.yaml           # 配置文件
├── requirements.txt
└── README.md
```

#### 技巧 3: **迭代式开发**

将复杂任务分解为多轮对话，逐步优化：

**第一轮：** 生成初始版本
```
实现一个滚动窗口回测函数，
输入是预测值和真实值的DataFrame
```

**第二轮：** 增加功能
```
在上面的回测函数中添加交易成本和延迟执行的考虑
```

**第三轮：** 优化和测试
```
添加单元测试，确保边界情况（如窗口小于5期）不会报错
```

#### 技巧 4: **系统化的错误调试**

遇到错误时，提供完整上下文帮助AI诊断：

```markdown
运行 backtest.py 时出现 KeyError: 'returns'

相关文件：@data_loader.py @backtest.py

请按以下步骤调查：
1. 检查 data_loader.py 返回的列名
2. 确认 backtest.py 中对列名的假设
3. 修复不一致，并添加输入验证
4. 运行测试确认修复有效
```

#### 技巧 5: **控制 Agent 的自主程度**

在 Cursor 设置中可以配置 Agent 的行为（Settings → Cursor Settings → Agents → Auto-Run）：

- **Run in Sandbox**（推荐）：在沙箱中自动运行命令，安全且高效
- **Ask Every Time**：所有操作都需要你批准（适合学习阶段）
- **Run Everything**：完全自主执行（适合信任度高的简单任务）

### 扩展 Cursor 能力：MCP 与 Skills

Cursor 的强大之处在于其可扩展性。通过 **MCP (Model Context Protocol)** 和 **Skills**，你可以让 AI 获得更多专业能力。

#### 什么是 MCP？

**Model Context Protocol (MCP)** 是一个开放协议，让 AI 可以调用外部工具和服务。想象一下：

- 让 AI 直接查询最新的技术文档（Context7）
- 让 AI 自动化浏览器操作进行网页抓取（Playwright）
- 让 AI 访问数据库、API、云服务等

::: {.callout-tip}
**MCP vs 传统 API**

MCP 不需要你编写代码来调用 API，AI 会自动判断何时使用、如何使用这些工具。
:::

#### 推荐的 MCP Servers

##### 1. **Context7** - 实时文档查询

让 AI 查询最新的编程库文档，避免使用过时信息：

```markdown
使用 pandas 2.0 的新特性处理时间序列数据
```

AI 会自动调用 Context7 查询最新文档，而不是依赖训练数据。

**安装方法：**
1. 打开 Cursor Settings → Context → Model Context Protocol
2. 点击 "Add MCP Server"
3. 搜索 "Context7"，点击安装并授权

##### 2. **Playwright** - 浏览器自动化

让 AI 自动抓取网页数据，无需手动编写爬虫代码：

```markdown
访问 Yahoo Finance，获取特斯拉最近三个月的股价数据
```

**安装方法：**
1. 在终端运行：
   ```bash
   npm install -g @playwright/mcp-server
   ```

2. 在项目根目录创建/编辑 `.cursor/mcp.json`：
   ```json
   {
     "mcpServers": {
       "playwright": {
         "command": "npx",
         "args": ["-y", "@playwright/mcp-server"]
       }
     }
   }
   ```

3. 重启 Cursor

##### 3. **其他实用 MCP Servers**

- **Filesystem** - 高级文件操作（批量重命名、搜索替换等）
- **GitHub** - 直接操作 GitHub（创建 PR、查看 Issues）
- **Brave Search** - 让 AI 实时搜索网页信息
- **Postgres** - 直接查询和操作数据库

::: {.callout-warning}
**使用 MCP 的注意事项**

- MCP 工具可以执行实际操作（如删除文件、发送请求），使用前请确保理解其功能
- 建议在设置中选择 "Ask Every Time"，在熟悉后再改为自动执行
- 对于需要 API key 的服务，注意保护密钥安全（使用环境变量或 `.env` 文件）
:::

#### 什么是 Skills？

**Skills** 是预制的工作流程模板，帮助 AI 更好地完成特定类型的任务。Skills 包含：

- 详细的步骤说明
- 最佳实践和注意事项
- 可执行的脚本

##### 推荐的 Skills

###### 1. **superpowers** - 增强 Agent 能力

这是一组强大的技能集，让 AI 能够：

- **系统性调试**：自动收集错误信息、查看日志、运行诊断
- **测试驱动开发**：先写测试，再写实现
- **规划驱动开发**：强制先规划再执行
- **代码审查**：自动检查代码质量、安全性、最佳实践

**安装方法：**
1. 打开 Cursor Settings → Rules → Project Rules
2. 点击 "Add Rule" → "Remote Rule (Github)"
3. 输入：`https://github.com/cursor-plugins/superpowers`
4. 确认安装

**使用示例：**
```markdown
我的测试失败了，报错是 "Connection timeout"

（AI 会自动使用 systematic-debugging skill，系统性地调查问题）
```

###### 2. **planning-with-files** - 文件化规划

将复杂任务的规划保存为文件，便于团队协作和进度追踪：

**安装：**
```bash
# 方法1：通过 Cursor 安装
Settings → Rules → Add Remote Rule
输入：https://github.com/cursor-plugins/planning-with-files

# 方法2：手动安装
mkdir -p ~/.cursor/skills
cd ~/.cursor/skills
git clone https://github.com/cursor-plugins/planning-with-files
```

**使用示例：**
```markdown
创建一个多因子选股模型，包括数据处理、因子计算、回测评估

（AI 会生成 task_plan.md、创建文件结构、跟踪进度）
```

###### 3. **其他实用 Skills**

- **ui-ux-pro-max** - 生成精美的 UI 界面
- **test-driven-development** - 强制测试先行
- **git-worktrees** - 使用 Git worktree 进行并行开发
- **code-review** - 系统性的代码审查流程

#### 如何安装 Skills？

**方法 1：从 GitHub 安装（推荐）**

1. 打开 Cursor Settings (`Cmd/Ctrl + ,`)
2. 导航到 Context → Rules → Project Rules
3. 点击 "Add Rule" → "Remote Rule (Github)"
4. 输入 Skill 的 GitHub 仓库 URL
5. 确认安装

**方法 2：手动安装**

```bash
# 项目级（仅当前项目）
mkdir -p .cursor/skills
cd .cursor/skills
git clone <skill-repo-url> <skill-name>

# 全局级（所有项目）
mkdir -p ~/.cursor/skills
cd ~/.cursor/skills
git clone <skill-repo-url> <skill-name>
```

**方法 3：创建自定义 Skill**

如果你有重复性的工作流程，可以创建自定义 Skill：

1. 在项目根目录创建 `.cursor/skills/deploy-app/SKILL.md`
2. 用 YAML frontmatter 定义元数据：
   ```markdown
   ---
   name: deploy-app
   description: 部署应用到测试或生产环境
   ---
   
   # Deploy App
   
   ## When to Use
   当用户提到"部署"、"发布"、"上线"时使用此技能
   
   ## Instructions
   1. 运行 `scripts/deploy.sh <environment>`
   2. 验证部署状态
   3. 更新部署日志
   ```
3. 在对话中输入 `/` 可以看到并调用自定义 Skills

::: {.callout-note}
**Skills 的自动激活**

安装后，AI 会根据你的提问自动判断是否需要使用某个 Skill。你也可以手动激活：

- 在对话框输入 `/` 查看所有可用 Skills
- 选择一个 Skill 后，AI 会按照其指引完成任务
:::

#### MCP 和 Skills 的配置文件位置

```
你的项目/
├── .cursor/
│   ├── mcp.json          # MCP 服务器配置（项目级）
│   └── skills/           # 项目级 Skills
│       ├── deploy-app/
│       └── custom-skill/
│
~/.cursor/                 # 用户主目录（全局配置）
├── mcp.json              # 全局 MCP 配置
└── skills/               # 全局 Skills（所有项目可用）
    ├── superpowers/
    └── planning-with-files/
```

#### 学习资源

- **MCP 官方文档**: [https://modelcontextprotocol.io](https://modelcontextprotocol.io)
- **Cursor Skills 文档**: [https://cursor.com/docs/context/skills](https://cursor.com/docs/context/skills)
- **MCP Servers 列表**: [https://github.com/modelcontextprotocol/servers](https://github.com/modelcontextprotocol/servers)
- **Superpowers Skills**: [https://github.com/cursor-plugins/superpowers](https://github.com/cursor-plugins/superpowers)

## 实战演示：一个完整的工作流

让我们通过一个真实案例展示如何使用 Cursor Agent 完成研究任务：

### 任务：构建基于BERT的财报情绪分析模型

::: {.callout-tip}
**推荐做法**：先在 Plan 模式（`Shift+Tab`）中让 AI 生成完整计划，审阅后再开始执行。
:::

**Step 1: 项目规划**（使用 Plan 模式）
```markdown
创建一个金融文本情绪分析项目：
- 使用 FinBERT 模型
- 数据：10-K 年报的 MD&A 部分
- 评估：情绪得分与未来收益率的 IC
- 需要处理：文本清洗、长文本截断、时间对齐

请先设计项目结构和数据流
```

**Step 2: 数据处理**（切换到 Agent 模式执行）
```markdown
@data/raw/ 中有原始 10-K 的 txt 文件

请创建 preprocessing.py：
1. 提取 MD&A section（用正则匹配 section 标题）
2. 清洗 HTML 标签和特殊字符
3. 按 512 token 切分长文本
4. 保存为 processed/mda_cleaned.csv
```

**Step 3: 模型构建**
```markdown
@preprocessing.py 

基于清洗后的数据，创建 model.py：
1. 加载 FinBERT（yiyanghkust/finbert-tone）
2. 批量推理，获取 positive/negative/neutral 概率
3. 计算复合情绪得分：pos - neg
4. 考虑 GPU 内存限制，使用 batch_size=16
```

**Step 4: 评估与可视化**
```markdown
@model.py @data/returns.csv

创建 evaluation.py：
1. 将情绪得分与未来1个月收益率对齐（注意披露日期滞后）
2. 计算时序 IC（按年度分组）
3. 生成可视化：IC 时间序列图、分位数组合收益图
4. 输出结果到 results/evaluation_report.html
```

**Step 5: 稳健性检验**
```markdown
@evaluation.py

增加稳健性分析：
1. 不同情绪指标（pos-neg vs pos/(pos+neg)）
2. 行业中性化（去除行业平均情绪）
3. 控制公司规模和账面市值比
4. 样本外测试（2020年后的数据）
```

通过这种方式，AI 可以在 10-20 分钟内完成一个初始版本的完整 pipeline，而你只需专注于：

- **研究设计**：如何定义情绪？如何对齐时间？
- **质量验收**：检查每个步骤的输出是否合理
- **结果解释**：IC=0.05 是否有经济意义？

## 学习资源与后续安排

### 必备软件安装

1. **Cursor IDE**: [https://cursor.sh](https://cursor.sh)（免费试用14天，之后$20/月）
2. **Python环境**: 建议使用Anaconda或Miniconda
3. **Git**: 用于版本控制和代码提交

### 推荐学习材料

**Cursor 相关：**
- **Cursor 官方文档**: [https://cursor.com/docs](https://cursor.com/docs)
- **Cursor Skills 文档**: [https://cursor.com/docs/context/skills](https://cursor.com/docs/context/skills)
- **MCP 官方网站**: [https://modelcontextprotocol.io](https://modelcontextprotocol.io)
- **Superpowers Skills**: [https://github.com/cursor-plugins/superpowers](https://github.com/cursor-plugins/superpowers)

**金融 AI 相关：**
- **FinBERT 等金融 NLP 模型**: [Hugging Face Model Hub](https://huggingface.co/models)
- **机器学习基础**: Hastie et al. (2009) *The Elements of Statistical Learning*
- **时序预测方法**: Hyndman & Athanasopoulos (2021) *Forecasting: Principles and Practice*

### 课程要求

- 第1-4周课前需完成指定阅读（见讲义中每周的阅读清单）
- 第5周前完成**课前测验**（开卷，覆盖核心概念）
- 第5-8周每组准备**15分钟研究计划汇报**
- 期末提交**详细研究计划书**（Detailed Research Plan）

::: {.callout-note}
本周行动清单

**软件配置：**
1. [ ] 安装 AI 编程工具（选择其一）：
   - **推荐**：Cursor IDE 并完成基础配置
   - **或**：Claude Code（Anthropic 官方）
   - **或**：国内工具（Trae / Kimi Code，无需科学上网）
   - **或**：Codex CLI（命令行爱好者）
2. [ ] （可选）安装至少一个 MCP Server（推荐 Context7，Cursor 和 Claude Code 支持）
3. [ ] （可选）安装 Superpowers Skills（Cursor 支持）

**动手实践：**
4. [ ] 尝试使用 AI 工具完成一个简单任务（如创建 Python 项目模板）
5. [ ] （Cursor 用户）尝试使用 Plan 模式（`Shift+Tab`）规划一个小项目
6. [ ] 测试 AI 工具的代码生成和解释能力

**理论学习：**
7. [ ] 阅读第1周必读材料：Hastie et al. (2009) Chapters 3, 7
8. [ ] 思考：你的研究方向如何与 AI 方法结合？

**参考安装命令：**
```bash
# Cursor 用户：安装 Playwright MCP（可选，用于网页数据抓取）
npm install -g @playwright/mcp-server

# Cursor 用户：安装 Superpowers Skills
# 在 Cursor 中：Settings → Rules → Add Remote Rule
# 输入：https://github.com/cursor-plugins/superpowers

# Codex CLI 用户：
pip install openai-codex-cli
# 或 npm install -g @openai/codex-cli
```
:::

接下来，我们将在**第1讲**深入学习机器学习的基础理论，建立i.i.d.场景下的完整认知框架。这是后续所有应用的理论基础，务必牢固掌握。
